---
sidebar: auto
---

# 单行函数

- 操作数据对象
- 接收参数返回一个结果
- 只对一行进行变换
- 每行返回一个结果
- 可以嵌套
- 参数可以是一列或一个值

## 数值函数

### 1、基本函数

| 函数                | 用法                                                                    |
| ------------------- | ----------------------------------------------------------------------- |
| ABS(x)              | 返回 x 的绝对值                                                         |
| SIGN(X)             | 返回 X 的符号。正数返回 1，负数返回-1，0 返回 0                         |
| PI()                | 返回圆周率的值                                                          |
| CEIL(x)，CEILING(x) | 返回大于或等于某个值的最小整数                                          |
| FLOOR(x)            | 返回小于或等于某个值的最大整数                                          |
| LEAST(e1,e2,e3…)    | 返回列表中的最小值                                                      |
| GREATEST(e1,e2,e3…) | 返回列表中的最大值                                                      |
| MOD(x,y)            | 返回 X 除以 Y 后的余数                                                  |
| RAND()              | 返回 0~1 的随机值                                                       |
| RAND(x)             | 返回 0~1 的随机值，其中 x 的值用作种子值，相同的 X 值会产生相同的随机数 |
| ROUND(x)            | 返回一个对 x 的值进行四舍五入后，最接近于 X 的整数                      |
| ROUND(x,y)          | 返回一个对 x 的值进行四舍五入后最接近 X 的值，并保留到小数点后面 Y 位   |
| TRUNCATE(x,y)       | 返回数字 x 截断为 y 位小数的结果                                        |
| SQRT(x)             | 返回 x 的平方根。当 X 的值为负数时，返回 NULL                           |

### 2、角度与弧度互换函数

| 函数       | 用法                                    |
| ---------- | --------------------------------------- |
| RADIANS(x) | 将角度转化为弧度，其中，参数 x 为角度值 |
| DEGREES(x) | 将弧度转化为角度，其中，参数 x 为弧度值 |

### 3、三角函数

| 函数       | 用法                                                                             |
| ---------- | -------------------------------------------------------------------------------- |
| SIN(x)     | 返回 x 的正弦值，其中，参数 x 为弧度值                                           |
| ASIN(x)    | 返回 x 的反正弦值，即获取正弦为 x 的值。如果 x 的值不在-1 到 1 之间，则返回 NULL |
| COS(x)     | 返回 x 的余弦值，其中，参数 x 为弧度值                                           |
| ACOS(x)    | 返回 x 的反余弦值，即获取余弦为 x 的值。如果 x 的值不在-1 到 1 之间，则返回 NULL |
| TAN(x)     | 返回 x 的正切值，其中，参数 x 为弧度值                                           |
| ATAN(x)    | 返回 x 的反正切值，即返回正切值为 x 的值                                         |
| ATAN2(m,n) | 返回两个参数的反正切值                                                           |
| COT(x)     | 返回 x 的余切值，其中，X 为弧度值                                                |

### 4、指数与对数

| 函数                 | 用法                                                       |
| -------------------- | ---------------------------------------------------------- |
| POW(x,y)，POWER(X,Y) | 返回 x 的 y 次方                                           |
| EXP(X)               | 返回 e 的 X 次方，其中 e 是一个常数，2.718281828459045     |
| LN(X)，LOG(X)        | 返回以 e 为底的 X 的对数，当 X <= 0 时，返回的结果为 NULL  |
| LOG10(X)             | 返回以 10 为底的 X 的对数，当 X <= 0 时，返回的结果为 NULL |
| LOG2(X)              | 返回以 2 为底的 X 的对数，当 X <= 0 时，返回 NULL          |

### 5、进制间的转换

| 函数          | 用法                         |
| ------------- | ---------------------------- |
| BIN(x)        | 返回 x 的二进制编码          |
| HEX(x)        | 返回 x 的十六进制编码        |
| OCT(x)        | 返回 x 的八进制编码          |
| CONV(x,f1,f2) | 返回 f1 进制数变成 f2 进制数 |

## 字符串函数

**注意：**

- 字符串的索引是从 1 开始的。

- 任何一个函数都可以看做是一个查询的字段，可以将使用别名。

  ```sql
  # 將名字拼接起来，并且使用 - 连接，最后再重命名为该字段为 姓名 。
  SELECT CONCAT(first_name, '-', last_name) '姓名' FROM employees;
  ```

| 函数                              | 用法                                                                                                                   |
| --------------------------------- | ---------------------------------------------------------------------------------------------------------------------- |
| ASCII(S)                          | 返回字符串 S 中的第一个字符的 ASCII 码值                                                                               |
| CHAR_LENGTH(s)                    | 返回字符串 s 的字符数。作用与 CHARACTER_LENGTH(s)相同，无论中文还是英文一个字或者字母都只算 1 个字符。                 |
| LENGTH(s)                         | 返回字符串 s 的字节数，和字符集有关，一个英文字母为 1 个字符，而一个汉子则是 3 个字符                                  |
| CONCAT(s1,s2,......,sn)           | 连接 s1,s2,......,sn 为一个字符串                                                                                      |
| CONCAT_WS(x, s1,s2,......,sn)     | 同 CONCAT(s1,s2,...)函数，但是每个字符串之间要加上 x                                                                   |
| INSERT(str, idx, len, replacestr) | 将字符串 str 从第 idx 位置开始，len 个字符长的子串替换为字符串 replacestr                                              |
| REPLACE(str, a, b)                | 用字符串 b 替换字符串 str 中所有出现的字符串 a                                                                         |
| UPPER(s) 或 UCASE(s)              | 将字符串 s 的所有字母转成大写字母                                                                                      |
| LOWER(s) 或 LCASE(s)              | 将字符串 s 的所有字母转成小写字母                                                                                      |
| LEFT(str,n)                       | 返回字符串 str 最左边的 n 个字符                                                                                       |
| RIGHT(str,n)                      | 返回字符串 str 最右边的 n 个字符                                                                                       |
| LPAD(str, len, pad)               | 用字符串 pad 对 str 最左边进行填充，直到 str 的长度为 len 个字符                                                       |
| RPAD(str ,len, pad)               | 用字符串 pad 对 str 最右边进行填充，直到 str 的长度为 len 个字符                                                       |
| LTRIM(s)                          | 去掉字符串 s 左侧的空格                                                                                                |
| RTRIM(s)                          | 去掉字符串 s 右侧的空格                                                                                                |
| TRIM(s)                           | 去掉字符串 s 开始与结尾的空格                                                                                          |
| TRIM(s1 FROM s)                   | 去掉字符串 s 开始与结尾的 s1                                                                                           |
| TRIM(LEADING s1 FROM s)           | 去掉字符串 s 开始处的 s1                                                                                               |
| TRIM(TRAILING s1 FROM s)          | 去掉字符串 s 结尾处的 s1                                                                                               |
| REPEAT(str, n)                    | 返回 str 重复 n 次的结果                                                                                               |
| SPACE(n)                          | 返回 n 个空格                                                                                                          |
| STRCMP(s1,s2)                     | 比较字符串 s1,s2 的 ASCII 码值的大小                                                                                   |
| SUBSTR(s,index,len)               | 返回从字符串 s 的 index 位置其 len 个字符，作用与 SUBSTRING(s,n,len)、MID(s,n,len)相同                                 |
| LOCATE(substr,str)                | 返回字符串 substr 在字符串 str 中首次出现的位置，作用于 POSITION(substr IN str)、INSTR(str,substr)相同。未找到，返回 0 |
| ELT(m,s1,s2,…,sn)                 | 返回指定位置的字符串，如果 m=1，则返回 s1，如果 m=2，则返回 s2，如果 m=n，则返回 sn                                    |
| FIELD(s,s1,s2,…,sn)               | 返回字符串 s 在字符串列表中第一次出现的位置                                                                            |
| FIND_IN_SET(s1,s2)                | 返回字符串 s1 在字符串 s2 中出现的位置。其中，字符串 s2 是一个以逗号分隔的字符串                                       |
| REVERSE(s)                        | 返回 s 反转后的字符串                                                                                                  |
| NULLIF(value1,value2)             | 比较两个字符串，如果 value1 与 value2 相等，则返回 NULL，否则返回 value1                                               |

## 日期和时间函数

### 获取时间日期

| 函数                                                                         | 用法                           |
| ---------------------------------------------------------------------------- | ------------------------------ |
| **CURDATE()** ，CURRENT_DATE()                                               | 返回当前日期，只包含年、月、日 |
| **CURTIME()** ， CURRENT_TIME()                                              | 返回当前时间，只包含时、分、秒 |
| **NOW()** / SYSDATE() / CURRENT_TIMESTAMP() / LOCALTIME() / LOCALTIMESTAMP() | 返回当前系统日期和时间         |
| UTC_DATE()                                                                   | 返回 UTC（世界标准时间）日期   |
| UTC_TIME()                                                                   | 返回 UTC（世界标准时间）时间   |

### 1、日期与时间戳的转换

| 函数                     | 用法                                                                   |
| ------------------------ | ---------------------------------------------------------------------- |
| UNIX_TIMESTAMP()         | 以 UNIX 时间戳的形式返回当前时间。SELECT UNIX_TIMESTAMP() ->1634348884 |
| UNIX_TIMESTAMP(date)     | 将时间 date 以 UNIX 时间戳的形式返回。                                 |
| FROM_UNIXTIME(timestamp) | 将 UNIX 时间戳的时间转换为普通格式的时间                               |

### 2、获取月份、星期、星期数、天数等函数

| 函数                                     | 用法                                                 |
| ---------------------------------------- | ---------------------------------------------------- |
| YEAR(date) / MONTH(date) / DAY(date)     | 返回具体的日期值                                     |
| HOUR(time) / MINUTE(time) / SECOND(time) | 返回具体的时间值                                     |
| MONTHNAME(date)                          | 返回月份：January，...                               |
| DAYNAME(date)                            | 返回星期几：MONDAY，TUESDAY.....SUNDAY               |
| WEEKDAY(date)                            | 返回周几，注意，周 1 是 0，周 2 是 1，。。。周日是 6 |
| QUARTER(date)                            | 返回日期对应的季度，范围为 1 ～ 4                    |
| WEEK(date) ， WEEKOFYEAR(date)           | 返回一年中的第几周                                   |
| DAYOFYEAR(date)                          | 返回日期是一年中的第几天                             |
| DAYOFMONTH(date)                         | 返回日期位于所在月份的第几天                         |
| DAYOFWEEK(date)                          | 返回周几，注意：周日是 1，周一是 2，。。。周六是 7   |

### 3、日期的操作函数

| 函数                    | 用法                                        |
| ----------------------- | ------------------------------------------- |
| EXTRACT(type FROM date) | 返回指定日期中特定的部分，type 指定返回的值 |

type 取值说明

| 值                 | 说明            |
| ------------------ | --------------- |
| MICROSECOND        | 毫秒            |
| SECOND             | 秒              |
| MINUTE             | 分              |
| HOUR               | 时              |
| DAY                | 天              |
| WEEK               | 周              |
| MONTH              | 月              |
| QUARTER            | 季度            |
| YEAR               | 年              |
| SECOND_MICROSECOND | 秒.毫秒         |
| MINUTE_MICROSECOND | 分.秒.毫秒      |
| MINUTE_SECOND      | 分.秒           |
| HOUR_MICROSECOND   | 小时.分.秒.毫秒 |
| HOUR_SECOND        | 小时.分.秒      |
| HOUR_MINUTE        | 小时.分         |
| DAY_MICROSECOND    | 小时.分.秒.毫秒 |
| DAY_SECOND         | 小时.分.秒      |
| DAY_MINUTE         | 小时.分钟       |
| DAY_HOUR           | 小时            |
| YEAR_MONTH         | 年.月           |

### 4、时间和秒钟转换的函数

| 函数                 | 用法                                                               |
| -------------------- | ------------------------------------------------------------------ |
| TIME_TO_SEC(time)    | 将 time 转化为秒并返回结果值。转化的公式为：`小时*3600+分钟*60+秒` |
| SEC_TO_TIME(seconds) | 将 seconds 描述转化为包含小时、分钟和秒的时间                      |

### 5、计算日期和时间的函数

一组

| 函数                                                                     | 用法                                             |
| ------------------------------------------------------------------------ | ------------------------------------------------ |
| DATE_ADD(datetime, INTERVAL expr type)，ADDDATE(date,INTERVAL expr type) | 返回与给定日期时间相差 INTERVAL 时间段的日期时间 |
| DATE_SUB(date,INTERVAL expr type)，SUBDATE(date,INTERVAL expr type)      | 返回与 date 相差 INTERVAL 时间间隔的日期         |

type 可选值

| 值                 | 说明      |
| ------------------ | --------- |
| MICROSECOND        | 毫秒数    |
| SECOND             | 秒数      |
| MINUTE             | 分钟数    |
| HOUR               | 小时数    |
| DAY                | 天数      |
| WEEK               | 周数      |
| MONTH              | 月数      |
| QUARTER            | 季度数    |
| YEAR               | 年数      |
| SECOND_MICROSECOND | 秒.豪秒   |
| MINUTE_MICROSECOND | 分.豪秒   |
| MINUTE_SECOND      | 分.秒     |
| HOUR_MICROSECOND   | 小时.豪秒 |
| HOUR_SECOND        | 小时.秒   |
| HOUR_MINUTE        | 小时.分   |
| DAY_MICROSECOND    | 天.豪秒   |
| DAY_SECOND         | 天.秒     |
| DAY_MINUTE         | 天.分钟   |
| DAY_HOUR           | 天.小时   |
| YEAR_MONTH         | 年.月     |

二组

| 函数                         | 用法                                                                            |
| ---------------------------- | ------------------------------------------------------------------------------- |
| ADDTIME(time1,time2)         | 返回 time1 加上 time2 的时间。当 time2 为一个数字时，代表的是`秒`，可以为负数   |
| SUBTIME(time1,time2)         | 返回 time1 减去 time2 后的时间。当 time2 为一个数字时，代表的是`秒`，可以为负数 |
| DATEDIFF(date1,date2)        | 返回 date1 - date2 的日期间隔天数                                               |
| TIMEDIFF(time1, time2)       | 返回 time1 - time2 的时间间隔                                                   |
| FROM_DAYS(N)                 | 返回从 0000 年 1 月 1 日起，N 天以后的日期                                      |
| TO_DAYS(date)                | 返回日期 date 距离 0000 年 1 月 1 日的天数                                      |
| LAST_DAY(date)               | 返回 date 所在月份的最后一天的日期                                              |
| MAKEDATE(year,n)             | 针对给定年份与所在年份中的天数返回一个日期                                      |
| MAKETIME(hour,minute,second) | 将给定的小时、分钟和秒组合成时间并返回                                          |
| PERIOD_ADD(time,n)           | 返回 time 加上 n 后的时间                                                       |

### 6、日期的格式化与解析

| 函数                              | 用法                                           |
| --------------------------------- | ---------------------------------------------- |
| DATE_FORMAT(date,fmt)             | 按照字符串 fmt 格式化日期 date 值              |
| TIME_FORMAT(time,fmt)             | 按照字符串 fmt 格式化时间 time 值              |
| GET_FORMAT(date_type,format_type) | 返回日期字符串的显示格式                       |
| STR_TO_DATE(str, fmt)             | 按照字符串 fmt 对 str 进行解析，解析为一个日期 |

上述`非GET_FORMAT`函数中 fmt 参数常用的格式符：

| 格式符 | 说明                                                          | 格式符  | 说明                                                          |
| ------ | ------------------------------------------------------------- | ------- | ------------------------------------------------------------- |
| %Y     | 4 位数字表示年份                                              | %y      | 表示两位数字表示年份                                          |
| %M     | 月名表示月份（January,....）                                  | %m      | 两位数字表示月份（01,02,03。。。）                            |
| %b     | 缩写的月名（Jan.，Feb.，....）                                | %c      | 数字表示月份（1,2,3,...）                                     |
| %D     | 英文后缀表示月中的天数（1st,2nd,3rd,...）                     | %d      | 两位数字表示月中的天数(01,02...)                              |
| %e     | 数字形式表示月中的天数（1,2,3,4,5.....）                      |         |                                                               |
| %H     | 两位数字表示小数，24 小时制（01,02..）                        | %h 和%I | 两位数字表示小时，12 小时制（01,02..）                        |
| %k     | 数字形式的小时，24 小时制(1,2,3)                              | %l      | 数字形式表示小时，12 小时制（1,2,3,4....）                    |
| %i     | 两位数字表示分钟（00,01,02）                                  | %S 和%s | 两位数字表示秒(00,01,02...)                                   |
| %W     | 一周中的星期名称（Sunday...）                                 | %a      | 一周中的星期缩写（Sun.，Mon.,Tues.，..）                      |
| %w     | 以数字表示周中的天数(0=Sunday,1=Monday....)                   |         |                                                               |
| %j     | 以 3 位数字表示年中的天数(001,002...)                         | %U      | 以数字表示年中的第几周，（1,2,3。。）其中 Sunday 为周中第一天 |
| %u     | 以数字表示年中的第几周，（1,2,3。。）其中 Monday 为周中第一天 |         |                                                               |
| %T     | 24 小时制                                                     | %r      | 12 小时制                                                     |
| %p     | AM 或 PM                                                      | %%      | 表示%                                                         |

## 流程控制函数
